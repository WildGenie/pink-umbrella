@using PinkUmbrella.ViewModels.Shop
@model IndexViewModel
@{
    ViewData["Title"] = "Shops by Tag";
}
<partial name="_Header" />
@if (Model.Categories != null)
{
    foreach (var category in Model.Categories.Items)
    {
        <h3>@category.Tag.Tag (@category.UseCount)</h3>
        <p>@category.Tag.Topic</p>
        foreach (var shop in Model.ShopsByCategory[category.Tag.Id])
        {
            <ul>
                <li><partial name="SearchResult/ShopSearchResult" model="shop" /></li>
            </ul>
        }
        <hr />
    }
}
else
{
    foreach (var shop in Model.ShopsList)
    {
        <partial name="Shop/DisplayResult" model="shop" />
        <hr />
    }
}